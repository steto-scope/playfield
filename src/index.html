<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title></title>
	<script src="js/set.js"></script>
  <script src="js/oneopstructure.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="playfield.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="navi">
        <div class="logo"></div>
        <div class="controls">
          <div class="buttons">
            <input type="button" id="newStructure" value="Neu..."></input>
            <input type="button" id="delStructure" value="-"></input>
          </div>
          <div class="structureSelection">
            <div>
              <select size="10" id="structSelection" onchange="structChanged();"></select>
            </div>
          </div>
          <input type="button" id="aboutButton" value="Über..."></input>
        </div>

      </div>
      <div class="content">
        <div class="newStructure ui-widget" id="createNewDialog" title="Neue Struktur">
          <form>
              <fieldset>
                <p>
                <label for="name">Name: </label>
                <input type="text" name="name" id="name" size="2" value="G" class="text ui-widget-content ui-corner-all">
              </p>
              <p>
                <label for="n">Anzahl Elemente: </label>
                <input id="n" value="2" size="2">
              </p>
              <p>
                <div class="controlgroup" style="display:none;">
                  <label for="addop">Addition</label>
                  <input type="checkbox" id="addop" name="opgroup" checked>
                  <label for="mulop">Multiplikation</label>
                  <input type="checkbox" id="mulop" name="opgroup">
                </div>
              </p>
                <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
              </fieldset>
            </form>
        </div>
      </div>
      <div  class=" ui-widget" id="about" title="Über">
        <h1>Galois' Playfield</h1>
        <br>
        <div style="margin:auto; width:500px;">
          <table>
            <tr>
              <th>Version:</th>
              <td>0.1</td>
            </tr>
            <tr>
              <th>Autor:</th>
              <td>Stefan Tobert</td>
            </tr>
            <tr>
              <th>Lizenz:</th>
              <td>MIT</td>
            </tr>
            <tr>
              <th>Quellcode:</th>
              <td><a href="https://github.com/steto-scope/playfield" target="_blank">https://github.com/steto-scope/playfield</a></td>
            </tr>
            <th>Verwendete Komponenten:</th>
            <td>jQuery v1.12.4<br>jQuery UI v1.12.1</td>
          </table>
        </div>
        <br>
        <ul>
          <li>
            <strong>v0.1</strong>
            <ul>
              <li>Anlegen von Strukturen mit 1 Operator</li>
              <li>Grundarchitektur</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </body>
 <script>



var structureList = [];

function s() {
  return structureList[document.getElementById('structSelection').value];
}

function nameSuggestion()
{
  var suggestion = "A";
  var used = false;
  do
  {
    used=false;
    for(var i=0; i<structureList.length; i++)
    {
      if(structureList[i].name == suggestion)
        {
          used = true;
          break;
        }
    }
    if(used)
      suggestion = String.fromCharCode(suggestion.charCodeAt()+1);
  }
  while(used);

  return suggestion;
}

function structChanged()
{

}

function sl_addNew(n,name,add,mul)
{
  var m = new Set();
  if((add ^ mul))
  {
    var g = new OneOpStructure(m);
    g.opStr = add ? "(a+b)%n" : "(a*b)%n";
    g.opSymbol = add ? "⊕" : "⊛";
    g.name = name;
    g.setElements(n);
    structureList.push(g);
  }
  update_sl();
}

function sl_delete(index)
{
  structureList.splice(index,1);
  update_sl();
}

function update_sl() {
  var o = "";
  for(var i=0; i<structureList.length; i++)
  {
    o+='<option value="'+i+'">'+structureList[i]+'</option>';
  }
  document.getElementById('structSelection').innerHTML = o;

}

 var dialog, form, about;

function addStructure() {
  var name = $( "#name" )[0].value, n = $( "#n" ), addop=$("#addop"), mulop=$("#mulop");
  var valid = true;
  valid = valid && name.trim().length > 0;
  valid = valid && parseInt(n[0].value) >=0 && parseInt(n[0].value) <=32;
  valid = valid && (addop[0].checked || mulop[0].checked);
  if(valid)
  {
    sl_addNew(parseInt(n[0].value),name.trim(),addop[0].checked,mulop[0].checked);

    dialog.dialog("close");
  }
  return valid;
}

dialog = $( "#createNewDialog" ).dialog({
  autoOpen: false,
  modal: true,
  buttons: {
    "Erzeugen": addStructure,
    Cancel: function() {
      dialog.dialog( "close" );
    }
  },
  close: function() {
    form[ 0 ].reset();
  }
});
$( "#createNewDialog" ).on( "dialogopen", function( event, ui ) { $( "#name" )[0].value = nameSuggestion(); } );

about = $( "#about" ).dialog({
  autoOpen: false,
  height: 600,
  width: 800,
  modal: true,
  show:'fade',
  hide:'fade',
  buttons: {
    Cancel: function() {
      about.dialog( "close" );
    }
  },
  close: function() {
    form[ 0 ].reset();
  }
});

form = dialog.find( "form" ).on( "submit", function( event ) {
  event.preventDefault();
  addStructure();
});

$("#n").spinner();
$("#n").spinner('option', 'min',0);
$("#n").spinner('option', 'max',32);
$("#addop").checkboxradio({icon:false});
$("#mulop").checkboxradio({icon:false});
$(".controlgroup").controlgroup();


 $("#newStructure").button();
 $("#newStructure").click( function( event )  {
   event.preventDefault();
   dialog.dialog("open");
 } );

 $("#delStructure").button();
 $("#delStructure").click( function( event )  {
   event.preventDefault();
   sl_delete(document.getElementById('structSelection').value);
 } );
 $("#aboutButton").button();
 $("#aboutButton").click( function( event )  {
   event.preventDefault();
   about.dialog("open");
 } );

  </script>
</html>
